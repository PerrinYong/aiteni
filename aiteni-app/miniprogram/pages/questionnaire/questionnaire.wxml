<!--pages/questionnaire/questionnaire.wxml-->
<!-- æ ¹å®¹å™¨ä½¿ç”¨.page-container + åŠ¨æ€ç»‘å®šå®‰å…¨ç•™ç™½ -->
<view class="page-container" style="padding-top: {{safeTopPadding}}rpx;">
  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{isLoading}}" class="loading-container">
    <view class="loading">
      <view class="loading-spinner"></view>
      <text class="loading-text">åŠ è½½é—®å·ä¸­...</text>
    </view>
  </view>

  <!-- é—®å·å†…å®¹ -->
  <view wx:else class="questionnaire-content">
    
    <!-- å›ºå®šé¡¶éƒ¨åŒºåŸŸï¼šè¿›åº¦æ¡ + é¢˜ç›®ä¿¡æ¯ -->
    <view class="fixed-header">
      <!-- è¿›åº¦æ¡ -->
      <view class="progress-bar-container">
        <view class="progress-bar">
          <view class="progress-fill" style="width: {{progress}}%;"></view>
        </view>
        <text class="progress-text">{{progress}}% å®Œæˆ</text>
      </view>

      <!-- é—®é¢˜å¡ç‰‡å¤´éƒ¨ï¼ˆå›ºå®šä¸æ»šåŠ¨ï¼‰ -->
      <view class="question-header-area" animation="{{questionAnimation}}">
        <view class="question-header">
          <view class="question-title-group">
            <text class="question-number">Q{{currentIndex + 1}}</text>
            <view class="question-tier {{currentQuestionTier === 'advanced' ? 'tier-advanced' : 'tier-basic'}}">
              {{currentQuestionTier === 'advanced' ? 'è¿›é˜¶é¢˜' : 'åŸºç¡€é¢˜'}}
            </view>
          </view>
          <text class="dimension-tag chip chip-blue">{{currentQuestion.dimensionName}}</text>
        </view>

        <view class="question-content">
          <text class="question-text">{{currentQuestion.text}}</text>
        </view>
      </view>
    </view>

    <!-- å¯æ»šåŠ¨ç­”æ¡ˆåŒºåŸŸ -->
    <scroll-view class="scroll-answers" scroll-y="true" enhanced="true" show-scrollbar="true">
      <!-- é€‰é¡¹åˆ—è¡¨ -->
      <view class="options-list card" animation="{{questionAnimation}}">
        <view
          wx:for="{{currentQuestion.options}}"
          wx:key="id"
          class="option-item {{selectedAnswer === item.id ? 'selected' : ''}}"
          bindtap="selectOption"
          data-option-id="{{item.id}}"
        >
          <view class="option-radio">
            <view wx:if="{{selectedAnswer === item.id}}" class="radio-checked">
              <text class="radio-icon">âœ“</text>
            </view>
            <view wx:else class="radio-unchecked"></view>
          </view>
          <view class="option-content">
            <text class="option-text">{{item.text}}</text>
          </view>
        </view>
      </view>
      
      <!-- æç¤ºä¿¡æ¯ -->
      <view class="hint-text">
        <text class="hint-icon">ğŸ’¡</text>
        <text>è¯·æ ¹æ®ä½ çš„çœŸå®æƒ…å†µé€‰æ‹©ï¼Œè¯„æµ‹ç»“æœæ›´å‡†ç¡®</text>
      </view>

      <!-- åº•éƒ¨å ä½ï¼Œé˜²æ­¢å†…å®¹è¢«å›ºå®šæŒ‰é’®é®æŒ¡ -->
      <view class="bottom-placeholder"></view>
    </scroll-view>

    <!-- å›ºå®šåº•éƒ¨å¯¼èˆªæ  -->
    <view class="fixed-bottom-nav">
      <button
        wx:if="{{currentIndex > 0}}"
        class="btn-secondary nav-btn"
        bindtap="prevQuestion"
      >
        <text>ä¸Šä¸€é¢˜</text>
      </button>
      <button
        class="btn-primary nav-btn {{!selectedAnswer ? 'disabled' : ''}}"
        bindtap="nextQuestion"
        disabled="{{!selectedAnswer}}"
      >
        <text>{{isLastQuestion ? 'æäº¤è¯„æµ‹' : 'ä¸‹ä¸€é¢˜'}}</text>
      </button>
    </view>
  </view>
</view>
