<!--pages/questionnaire/questionnaire.wxml-->
<view class="container">
  <!-- è‡ªå®šä¹‰å¯¼èˆªæ  -->
  <view class="custom-navbar" style="padding-top: {{statusBarHeight}}px;">
    <view class="navbar-content">
      <view class="navbar-left">
        <view class="icon-btn" bindtap="goBack">
          <text class="icon-back">â€¹</text>
        </view>
      </view>
      <view class="navbar-center">
        <view class="brand-mark">
          <view class="brand-mark__i"></view>
          <view class="brand-mark__ball"></view>
          <view class="brand-mark__court"></view>
        </view>
        <text class="navbar-title">NTRP è¯„æµ‹</text>
      </view>
      <view class="navbar-right">
        <text class="question-counter">{{currentIndex + 1}}/{{totalQuestions}}</text>
      </view>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{isLoading}}" class="loading-container">
    <view class="loading">
      <view class="loading-spinner"></view>
      <text class="loading-text">åŠ è½½é—®å·ä¸­...</text>
    </view>
  </view>

  <!-- é—®å·å†…å®¹ -->
  <view wx:else class="questionnaire-content" style="padding-top: {{navbarHeight + statusBarHeight}}px;">
    <!-- è¿›åº¦æ¡ -->
    <view class="progress-bar-container">
      <view class="progress-bar">
        <view class="progress-fill" style="width: {{progress}}%;"></view>
      </view>
      <text class="progress-text">{{progress}}% å®Œæˆ</text>
    </view>

    <!-- é—®é¢˜å¡ç‰‡ -->
    <view class="question-card card" animation="{{questionAnimation}}">
      <view class="question-header">
        <view class="question-badge">
          <text class="question-number">Q{{currentIndex + 1}}</text>
        </view>
        <view class="question-dimension">
          <text class="dimension-tag chip chip-blue">{{currentQuestion.dimensionName}}</text>
        </view>
      </view>

      <view class="question-content">
        <text class="question-text">{{currentQuestion.text}}</text>
      </view>

      <!-- é€‰é¡¹åˆ—è¡¨ -->
      <view class="options-list">
        <view
          wx:for="{{currentQuestion.options}}"
          wx:key="id"
          class="option-item {{selectedAnswer === item.id ? 'selected' : ''}}"
          bindtap="selectOption"
          data-option-id="{{item.id}}"
        >
          <view class="option-radio">
            <view wx:if="{{selectedAnswer === item.id}}" class="radio-checked">
              <text class="radio-icon">âœ“</text>
            </view>
            <view wx:else class="radio-unchecked"></view>
          </view>
          <view class="option-content">
            <text class="option-text">{{item.text}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- åº•éƒ¨å¯¼èˆª -->
    <view class="bottom-nav">
      <button
        wx:if="{{currentIndex > 0}}"
        class="btn-secondary nav-btn"
        bindtap="prevQuestion"
      >
        <text>ä¸Šä¸€é¢˜</text>
      </button>
      <button
        class="btn-primary nav-btn {{!selectedAnswer ? 'disabled' : ''}}"
        bindtap="nextQuestion"
        disabled="{{!selectedAnswer}}"
      >
        <text>{{isLastQuestion ? 'æäº¤è¯„æµ‹' : 'ä¸‹ä¸€é¢˜'}}</text>
      </button>
    </view>

    <!-- æç¤ºä¿¡æ¯ -->
    <view class="hint-text">
      <text class="hint-icon">ğŸ’¡</text>
      <text>è¯·æ ¹æ®ä½ çš„çœŸå®æƒ…å†µé€‰æ‹©ï¼Œè¯„æµ‹ç»“æœæ›´å‡†ç¡®</text>
    </view>
  </view>
</view>
